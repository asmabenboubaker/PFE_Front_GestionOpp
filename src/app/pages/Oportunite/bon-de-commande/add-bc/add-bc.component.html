<!-- Tabs navs -->

<!-- Tabs content -->

<div>
    <!--        <div  class="card-header text-center bg-secondary  text-white" style="background-color: #242f50 !important;">-->
    <!--            <h5> {{'caseRequest.TitleRqEdit'|translate}} ({{demandeForm.requestCaseNumber}})</h5>-->
    <!--        </div>-->
    <div>

        <div class="card-header text-center bg-secondary text-white" style="background-color: #40B3A2 !important;">
            <div class="d-flex justify-content-center align-items-center" style="width: 100%;">
                <div *ngIf="objectData !== undefined" class="d-flex align-items-center">
                    <h5 class="mb-0">Bon de commande N°:({{objectData?.id}})</h5>
                    <div class="icon-container ml-3" style="cursor: pointer;" (click)="showPopupWF()" title="{{'show-event.Voir la liste des événements' | translate}}">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="tab-content" id="ex2-content">
    <!-- acctiver when verification is true-->
    <div
            class="tab-pane fade {{ verification ? 'show active' : '' }}"
            id="ex3-tabs-1"
            role="tabpanel"
            aria-labelledby="ex3-tab-1"
            *ngIf="verification"
    >
        <style>

            .custom-field {
                border: 1px solid #40B3A2;
                border-top: none;
                margin-top: 32px ;

                padding: 8px;
                border-radius: 8px !important;
            }

            .custom-field h1 {
                font-size: 15px;
                margin: -16px -8px 0;
                color: #40B3A2;

                font-weight: 500;
            }

            .custom-field h1 span {
                float: left;
            }

            .custom-field h1:before {
                border-top: 1px solid #40B3A2;
                content: ' ';
                float: left;
                margin: 8px 2px 0 2px;
                width: 20px;
                border-radius: 8px !important;
            }

            .custom-field h1:after {
                border-top: 1px solid #40B3A2;
                content: ' ';
                display: block;
                height: 24px;
                left: 2px;
                margin: 0 1px 0 0;
                overflow: hidden;
                position: relative;
                top: 8px;
                border-top-right-radius: 8px ;
            }
            .fieldContent{

                padding: 20px;
            }

        </style>

        <div class="custom-field">
            <h1>
                    <span>
                       Bon de commande
                    </span>
            </h1>
            <div class="fieldContent">
        <form  [formGroup]="demandeF"  method="post" novalidate>
            <div class="form-group">
                <label>Service commandé:</label>
                <input type="text" formControlName="servicecommande" id="servicecommande" class="form-control" required>
            </div>


<!--            <div class="form-group">-->
<!--                <label>Statut:</label>-->
<!--                <select class="form-control"  id="statut">-->
<!--                    <option *ngFor="let status of statusList" [value]="status">{{ status }}</option>-->
<!--                </select>-->
<!--            </div>-->
            <div class="form-group">
                <label>Methode de paiement</label>

                <select formControlName="methodedepaiement" class="form-control">
                    <option value="carte">Carte de crédit</option>
                    <option value="virement">Virement bancaire</option>

                    <option value="espece">Espèces</option>
                    <option value="cheque">Chèque</option>
                </select>
            </div>
            <div class="form-group">
                <label>Offre </label>
<!-- list offre-->
                <select #selected class="form-control">
                    <option *ngFor="let of of offre" [value]="of.id">{{ of.description }}</option>
                </select>
            </div>
            <div class="form-group">
                <label>montant Total</label>
                <input class="form-control" formControlName="montantTotal" id="montantTotal" type="text" >
            </div>
            <div class="form-group">
                <label for="Datedelivraison" class="form-label">Date de livraison</label>
                <input class="form-control" formControlName="datedelivraison" id="datedelivraison" type="date">
            </div>
            <div class="form-group">
                <label>Description:</label>
                <textarea class="form-control" formControlName="description"  rows="5" cols="30" required></textarea>
            </div>


        </form>
            </div>
        </div>
        <div class="custom-field">
            <h1>
                    <span>
                        Gestion des fichiers
                    </span>
            </h1>
            <div class="fieldContent">

                <app-attachment *ngIf="objectData.id && objectData.id !== null"
                                [classid]="this.objectData.classId"
                                [objectid]="this.objectData.id"
                                [objectData]="objectData"
                                [isPublic]=false
                                (jsondocviewerEvent)="GetjsonDowViewerFromAttatchement($event)"
                                [withoutviewer]="true"
                                [ShowSplitter]=true
                                (refreshedReqFileDef)="getInstructionById(objectData.id)"
                                #attachmentComponent
                ></app-attachment>
            </div>
        </div>

        <div class="workflow-container">
            <app-workflow-decision
                    *ngIf="demandeForm &&(demandeForm['workflow']!=undefined ||!(this.demandeForm.userPermission == 'WRITE')) "
                    (decisionEvent)="Confirmation($event)"
                    (saveEvent)="save()"
                    (RetournEvent)="Retourn()"
                    [access]="demandeForm['userPermission'] === 'READ' || demandeForm['userPermission'] === 'NONE'"
                    [decisions]="decissionWF"
                    [object]="demandeForm"
                    [SaveObject]="demandeForm">
            </app-workflow-decision>

        </div>
    </div>
    <div
            class="tab-pane fade {{ traitement ? 'show active' : '' }}"
            id="ex3-tabs-2"
            role="tabpanel"
            aria-labelledby="ex3-tab-2"
            *ngIf="traitement"
    >
        <div class="custom-field">
            <h1>
                    <span>
                        Bon de commande
                    </span>
            </h1>
            <div class="fieldContent">
        <form  [formGroup]="demandeF"   method="post" novalidate>
            <div class="form-group">
                <label>Service commandé:</label>
                <input type="text" formControlName="servicecommande" class="form-control" required>
            </div>


<!--            <div class="form-group">-->
<!--                <label>Statut:</label>-->
<!--                <select class="form-control"  >-->
<!--                    <option *ngFor="let status of statusList" [value]="status">{{ status }}</option>-->
<!--                </select>-->
<!--            </div>-->
            <div class="form-group">
                <label>Methode de paiement</label>
                <select formControlName="methodedepaiement" class="form-control">
                    <option value="carte">Carte de crédit</option>
                    <option value="virement">Virement bancaire</option>

                    <option value="espece">Espèces</option>
                    <option value="cheque">Chèque</option>
                </select>
            </div>
            <div class="form-group">
                <label>montant Total</label>
                <input class="form-control" formControlName="montantTotal"   type="text" >
            </div>
            <div class="form-group">
                <label for="Datedelivraison" class="form-label">Date de livraison</label>
                <input class="form-control" formControlName="datedelivraison"  type="date">
            </div>
            <div class="form-group">
                <label>Description:</label>
                <textarea class="form-control" formControlName="description"  rows="5" cols="30" required></textarea>
            </div>

        </form>
            </div>
        </div>
        <div class="custom-field">
            <h1>
                    <span>
                        Gestion des fichiers
                    </span>
            </h1>
            <div class="fieldContent">

                <app-attachment *ngIf="objectData.id && objectData.id !== null"
                                [classid]="this.objectData.classId"
                                [objectid]="this.objectData.id"
                                [objectData]="objectData"
                                [isPublic]=false
                                (jsondocviewerEvent)="GetjsonDowViewerFromAttatchement($event)"
                                [withoutviewer]="true"
                                [ShowSplitter]=true
                                (refreshedReqFileDef)="getInstructionById(objectData.id)"
                                #attachmentComponent
                ></app-attachment>
            </div>
        </div>

        <div class="workflow-container">
            <app-workflow-decision
                    *ngIf="demandeForm &&(demandeForm['workflow']!=undefined ||!(this.demandeForm.userPermission == 'WRITE')) "
                    (decisionEvent)="Confirmation($event)"
                    (saveEvent)="save()"
                    (RetournEvent)="Retourn()"
                    [access]="demandeForm['userPermission'] === 'READ' || demandeForm['userPermission'] === 'NONE'"
                    [decisions]="decissionWF"
                    [object]="demandeForm"
                    [SaveObject]="demandeForm">
            </app-workflow-decision>

        </div>

    </div>
    <div
            class="tab-pane fade {{ validation ? 'show active' : '' }}"
            id="ex3-tabs-3"
            role="tabpanel"
            aria-labelledby="ex3-tab-3"
            *ngIf="validation"
    >
        <div class="custom-field">
            <h1>
                    <span>
                        Bon de commande
                    </span>
            </h1>
            <div class="fieldContent">
        <form  [formGroup]="demandeF"   method="post" novalidate>
            <div class="form-group">
                <label>Service commandé:</label>
                <input type="text" formControlName="servicecommande" class="form-control" required>
            </div>

            <div class="form-group">
                <label>Methode de paiement</label>
                <select formControlName="methodedepaiement" class="form-control">
                    <option value="carte">Carte de crédit</option>
                    <option value="virement">Virement bancaire</option>

                    <option value="espece">Espèces</option>
                    <option value="cheque">Chèque</option>
                </select>
            </div>
            <div class="form-group">
                <label>montant Total</label>
                <input class="form-control" formControlName="montantTotal"   type="text" >
            </div>
            <div class="form-group">
                <label for="Datedelivraison" class="form-label">Date de livraison</label>
                <input class="form-control" formControlName="datedelivraison"  type="date">
            </div>
            <div class="form-group">
                <label>Description:</label>
                <textarea class="form-control" formControlName="description"  rows="5" cols="30" required></textarea>
            </div>

        </form>
            </div>
        </div>
        <div class="custom-field">
            <h1>
                    <span>
                        Gestion des fichiers
                    </span>
            </h1>
            <div class="fieldContent">

                <app-attachment *ngIf="objectData.id && objectData.id !== null"
                                [classid]="this.objectData.classId"
                                [objectid]="this.objectData.id"
                                [objectData]="objectData"
                                [isPublic]=false
                                (jsondocviewerEvent)="GetjsonDowViewerFromAttatchement($event)"
                                [withoutviewer]="true"
                                [ShowSplitter]=true
                                (refreshedReqFileDef)="getInstructionById(objectData.id)"
                                #attachmentComponent
                ></app-attachment>
            </div>
        </div>

        <div class="workflow-container">
            <app-workflow-decision
                    *ngIf="demandeForm &&(demandeForm['workflow']!=undefined ||!(this.demandeForm.userPermission == 'WRITE')) "
                    (decisionEvent)="Confirmation($event)"
                    (saveEvent)="save()"
                    (RetournEvent)="Retourn()"
                    [access]="demandeForm['userPermission'] === 'READ' || demandeForm['userPermission'] === 'NONE'"
                    [decisions]="decissionWF"
                    [object]="demandeForm"
                    [SaveObject]="demandeForm">
            </app-workflow-decision>

        </div>

    </div>



        <!-- Content for new tab -->
        <div
                class="tab-pane fade {{ elsedesision ? 'show active' : '' }}"
                id="ex3-tabs-4"
                role="tabpanel"
                aria-labelledby="ex3-tab-4"
                *ngIf="elsedesision"
        >
            <div class="custom-field">
                <h1>
                    <span>
                       Bon de commande
                    </span>
                </h1>
                <div class="fieldContent">
            <form  [formGroup]="demandeF"   method="post" novalidate>
                <div class="form-group">
                    <label>Service commandé:</label>
                    <input type="text" formControlName="servicecommande" class="form-control" required>
                </div>

                <div class="form-group">
                    <label>Methode de paiement</label>
                    <select formControlName="methodedepaiement" class="form-control">
                        <option value="carte">Carte de crédit</option>
                        <option value="virement">Virement bancaire</option>

                        <option value="espece">Espèces</option>
                        <option value="cheque">Chèque</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>montant Total</label>
                    <input class="form-control" formControlName="montantTotal"   type="text" >
                </div>
                <div class="form-group">
                    <label for="Datedelivraison" class="form-label">Date de livraison</label>
                    <input class="form-control" formControlName="datedelivraison"  type="date">
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea class="form-control" formControlName="description"  rows="5" cols="30" required></textarea>
                </div>



            </form>
                </div>
            </div>
            <div class="custom-field">
                <h1>
                    <span>
                        Gestion des fichiers
                    </span>
                </h1>
                <div class="fieldContent">

                    <app-attachment *ngIf="objectData.id && objectData.id !== null"
                                    [classid]="this.objectData.classId"
                                    [objectid]="this.objectData.id"
                                    [objectData]="objectData"
                                    [isPublic]=false
                                    (jsondocviewerEvent)="GetjsonDowViewerFromAttatchement($event)"
                                    [withoutviewer]="true"
                                    [ShowSplitter]=true
                                    (refreshedReqFileDef)="getInstructionById(objectData.id)"
                                    #attachmentComponent
                    ></app-attachment>
                </div>
            </div>

            <div class="workflow-container">
                <app-workflow-decision
                        *ngIf="demandeForm &&(demandeForm['workflow']!=undefined ||!(this.demandeForm.userPermission == 'WRITE')) "
                        (decisionEvent)="Confirmation($event)"
                        (saveEvent)="save()"
                        (RetournEvent)="Retourn()"
                        [access]="demandeForm['userPermission'] === 'READ' || demandeForm['userPermission'] === 'NONE'"
                        [decisions]="decissionWF"
                        [object]="demandeForm"
                        [SaveObject]="demandeForm">
                </app-workflow-decision>

            </div>
        </div>

</div>
<dx-popup
        [showCloseButton]="true"
        [maxWidth]="'auto'"
        [width]="popupWidth"
        [height]="popupHeight"
        [showTitle]="false"
        title="Workflow Viewer"
        [dragEnabled]="false"
        [closeOnOutsideClick]="true"
        [(visible)]="popupViewerVisible">
    <div *dxTemplate="let data of 'content'">
        <app-journal [viewerUrl]="objectData.workflow.wfProcessID" [historicsWF]="objectData.workflow.historicWF" [historicsEvt]="objectData.events"
                     [historicsAcces]="objectData.userActivity"></app-journal>
    </div>
</dx-popup>
<dx-load-panel
    #loadPanel
    shadingColor="rgba(0,0,0,0)"
    [position]="{ of: '#employee' }"
    [(visible)]="loadingVisible"
    [showIndicator]="true"
    [showPane]="true"
    [shading]="true"
    [hideOnOutsideClick]="false"

>
</dx-load-panel>